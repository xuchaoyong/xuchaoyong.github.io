<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Process Programming with fork | To Build Your Life</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="1. Definition of fork() function
pid_t fork(void) is called once but returns twice. The only difference in the returns is that the return value in the child is 0, whereas the return value in the paren">
<meta property="og:type" content="article">
<meta property="og:title" content="Process Programming with fork">
<meta property="og:url" content="http://yoursite.com/2015/03/07/Process-Programming-with-fork/">
<meta property="og:site_name" content="To Build Your Life">
<meta property="og:description" content="1. Definition of fork() function
pid_t fork(void) is called once but returns twice. The only difference in the returns is that the return value in the child is 0, whereas the return value in the paren">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Process Programming with fork">
<meta name="twitter:description" content="1. Definition of fork() function
pid_t fork(void) is called once but returns twice. The only difference in the returns is that the return value in the child is 0, whereas the return value in the paren">

  
    <link rel="alternative" href="/atom.xml" title="To Build Your Life" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">

  

</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">To Build Your Life</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="submit" value="&#xF002;" class="search-form-submit"><input type="hidden" name="q" value="site:http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Process-Programming-with-fork" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/03/07/Process-Programming-with-fork/" class="article-date">
  <time datetime="2015-03-07T14:36:06.000Z" itemprop="datePublished">Mar 7 2015</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Process Programming with fork
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="1-_Definition_of_fork()_function">1. Definition of fork() function</h3>
<p>pid_t fork(void) is called once but returns twice. The only difference in the returns is that the return value in the child is 0, whereas the return value in the parent is the process ID of the new child.</p>
<h3 id="2-_Program_Example">2. Program Example</h3>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;unistd.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdlib.h&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> g_count; <span class="comment">/*Global variable which would be initialized to 0.*/</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> main()</div><div class="line">{</div><div class="line">    <span class="keyword">using</span> std::<span class="built_in">cout</span>;</div><div class="line">    <span class="keyword">int</span> var;</div><div class="line">    pid_t pid;</div><div class="line">	  </div><div class="line">    var = <span class="number">88</span>; </div><div class="line"></div><div class="line">    std::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Before fork\n"</span>;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> ((pid = fork()) &lt; <span class="number">0</span>)</div><div class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"fork error!\n"</span>;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (pid == <span class="number">0</span>)</div><div class="line">    {		          </div><div class="line">      g_count++;			      </div><div class="line">      var++;</div><div class="line">    }	      </div><div class="line">    <span class="keyword">else</span></div><div class="line">      ::sleep(<span class="number">2</span>);</div><div class="line">		    </div><div class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"pid = "</span> &lt;&lt; getpid() &lt;&lt; <span class="string">" g_count = "</span> &lt;&lt; g_count &lt;&lt; <span class="string">" var = "</span> &lt;&lt; var &lt;&lt; <span class="string">"\n"</span>;</div><div class="line">    ::<span class="built_in">exit</span>(<span class="number">0</span>);		        </div><div class="line">}</div></pre></td></tr></table></figure>

<h1 id="Execution_Result">Execution Result</h1>
<p>$ ./a.out<br>a write to stdout<br>before fork<br>pid = 430, glob = 7, var = 89      child’s variables were changed<br>pid = 429, glob = 6, var = 88      parent’s copy was not changed<br>$ ./a.out &gt; temp.out<br>$ cat temp.out<br>a write to stdout<br>before fork<br>pid = 432, glob = 7, var = 89<br>before fork<br>pid = 431, glob = 6, var = 88</p>
<p>The previous program may has different result when you choose differnt standard out. You would get one “before fork” string with your terminal as std out; however, twice string would appear when you select the file as your output. It is caused by the printf function buffer which would be flushed by newline in the terminal output, but fully buffered with files. What’s more, the variable does not changed in the parent process while be abstracted by 1 in the child process.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/03/07/Process-Programming-with-fork/" data-id="h73f37cye9gows48" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Operating-System/">Operating System</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2015/01/11/Unix-Networking-Programming-Learning-1/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Unix Networking Programming Learning 1</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Operating-System/">Operating System</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Reading/">Reading</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Unix-Networking-Programming/">Unix Networking Programming</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Operating-System/" style="font-size: NaNpx;">Operating System</a><a href="/tags/Reading/" style="font-size: NaNpx;">Reading</a><a href="/tags/Unix-Networking-Programming/" style="font-size: NaNpx;">Unix Networking Programming</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">March 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">January 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">November 2014</a><span class="archive-list-count">2</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2015/03/07/Process-Programming-with-fork/">Process Programming with fork</a>
          </li>
        
          <li>
            <a href="/2015/01/11/Unix-Networking-Programming-Learning-1/">Unix Networking Programming Learning 1</a>
          </li>
        
          <li>
            <a href="/2015/01/11/Reading-note-2-of-THE-POWER-of-HABIT/">Reading Note 2 of THE POWER of HABIT</a>
          </li>
        
          <li>
            <a href="/2014/11/09/first-post/">first post</a>
          </li>
        
          <li>
            <a href="/2014/11/08/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2015 Charlie<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">

  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>



<script src="/js/script.js" type="text/javascript"></script>


  </div>
</body>
</html>